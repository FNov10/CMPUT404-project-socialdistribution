{
  "version": 3,
  "names": [
    "React",
    "useState",
    "useRef",
    "useImperativeHandle",
    "Fragment",
    "useEffect",
    "useCallback",
    "markdown",
    "markdownLanguage",
    "languages",
    "EditorView",
    "events",
    "CodeMirror",
    "MarkdownPreview",
    "ToolBar",
    "getCommands",
    "getModeCommands",
    "defaultTheme",
    "scrollerStyle",
    "theme",
    "borderBottomRightRadius",
    "borderBottomLeftRadius",
    "MarkdownEditor",
    "forwardRef",
    "MarkdownEditorInternal",
    "Markdown",
    "props",
    "ref",
    "prefixCls",
    "className",
    "onChange",
    "toolbars",
    "toolbarsMode",
    "toolbarsFilter",
    "visible",
    "renderPreview",
    "visibleEditor",
    "hideToolbar",
    "toolbarBottom",
    "enableScroll",
    "previewProps",
    "extensions",
    "previewWidth",
    "reExtensions",
    "codemirrorProps",
    "value",
    "setValue",
    "codeMirror",
    "container",
    "containerEditor",
    "preview",
    "active",
    "editor",
    "toolBarProps",
    "editorProps",
    "height",
    "previewScrollHandle",
    "event",
    "target",
    "percent",
    "scrollTop",
    "scrollHeight",
    "current",
    "previewHeihgt",
    "view",
    "editorScrollDom",
    "scrollDOM",
    "editorScrollHeihgt",
    "mouseoverHandle",
    "mouseleaveHandle",
    "$preview",
    "addEventListener",
    "removeEventListener",
    "scrollExtensions",
    "scroll",
    "extensionsData",
    "base",
    "codeLanguages",
    "push",
    "clsPreview",
    "cls",
    "filter",
    "Boolean",
    "join",
    "handleChange",
    "viewUpdate",
    "conentView",
    "clsToolbar",
    "tools",
    "toolsMode",
    "toolbarView",
    "child"
  ],
  "sources": [
    "../src/index.tsx"
  ],
  "sourcesContent": [
    "import React, { useState, useRef, useImperativeHandle, Fragment, useEffect, useCallback } from 'react';\nimport { markdown, markdownLanguage } from '@codemirror/lang-markdown';\nimport { languages } from '@codemirror/language-data';\nimport { EditorView, ViewUpdate } from '@codemirror/view';\nimport * as events from '@uiw/codemirror-extensions-events';\nimport CodeMirror, { ReactCodeMirrorProps, ReactCodeMirrorRef } from '@uiw/react-codemirror';\nimport MarkdownPreview, { MarkdownPreviewProps } from '@uiw/react-markdown-preview';\nimport ToolBar, { Commands } from './components/ToolBar';\nimport { getCommands, getModeCommands } from './commands';\nimport { defaultTheme } from './theme';\nimport './index.less';\n\nexport * from './theme';\nexport * from './commands';\nexport * from '@uiw/react-markdown-preview';\n\nexport const scrollerStyle = EditorView.theme({\n  '&.cm-editor, & .cm-scroller': {\n    borderBottomRightRadius: '3px',\n    borderBottomLeftRadius: '3px',\n  },\n});\n\nexport interface IMarkdownEditor extends ReactCodeMirrorProps {\n  className?: string;\n  prefixCls?: string;\n  /** The raw markdown that will be converted to html (**required**) */\n  value?: string;\n  /** Shows a preview that will be converted to html. */\n  visible?: boolean;\n  visibleEditor?: boolean;\n  /** Override the default preview component */\n  renderPreview?: (props: MarkdownPreviewProps, initVisible: boolean) => React.ReactNode;\n  /** Preview expanded width @default `50%` */\n  previewWidth?: string;\n  /** Whether to enable scrolling */\n  enableScroll?: boolean;\n  /** Tool display settings. */\n  toolbars?: Commands[];\n  /** The tool on the right shows the settings. */\n  toolbarsMode?: Commands[];\n  /** Tool display filter settings. */\n  toolbarsFilter?: (tool: Commands, idx: number) => boolean;\n  /** Toolbar on bottom */\n  toolbarBottom?: boolean;\n  /** Option to hide the tool bar. */\n  hideToolbar?: boolean;\n  /** [@uiw/react-markdown-preview](https://github.com/uiwjs/react-markdown-preview#options-props) options */\n  previewProps?: MarkdownPreviewProps;\n  /** replace the default `extensions` */\n  reExtensions?: ReactCodeMirrorProps['extensions'];\n}\n\nexport interface ToolBarProps {\n  editor: React.RefObject<ReactCodeMirrorRef>;\n  preview: React.RefObject<HTMLDivElement>;\n  container: React.RefObject<HTMLDivElement>;\n  containerEditor: React.RefObject<HTMLDivElement>;\n  editorProps: IMarkdownEditor;\n}\n\nexport interface MarkdownEditorRef {\n  editor: React.RefObject<ReactCodeMirrorRef>;\n  preview: React.RefObject<HTMLDivElement> | null;\n}\n\nconst MarkdownEditor: MarkdownEditorComponent = React.forwardRef<MarkdownEditorRef, IMarkdownEditor>(\n  MarkdownEditorInternal,\n) as unknown as MarkdownEditorComponent;\n\ntype MarkdownEditorComponent = React.FC<React.PropsWithRef<IMarkdownEditor>> & {\n  Markdown: typeof MarkdownPreview;\n};\n\nMarkdownEditor.Markdown = MarkdownPreview;\n\nexport default MarkdownEditor;\n\nfunction MarkdownEditorInternal(\n  props: IMarkdownEditor,\n  ref?: ((instance: MarkdownEditorRef) => void) | React.RefObject<MarkdownEditorRef> | null,\n) {\n  const {\n    prefixCls = 'md-editor',\n    className,\n    onChange,\n    toolbars = getCommands(),\n    toolbarsMode = getModeCommands(),\n    toolbarsFilter,\n    visible = true,\n    renderPreview,\n    visibleEditor = true,\n    hideToolbar = true,\n    toolbarBottom = false,\n    enableScroll = true,\n    previewProps = {},\n    extensions = [],\n    previewWidth = '50%',\n    reExtensions,\n    ...codemirrorProps\n  } = props;\n  const [value, setValue] = useState(props.value || '');\n  const codeMirror = useRef<ReactCodeMirrorRef>(null);\n  const container = useRef<HTMLDivElement>(null);\n  const containerEditor = useRef<HTMLDivElement>(null);\n  const preview = useRef<HTMLDivElement>(null);\n  const active = useRef<'editor' | 'preview'>('editor');\n\n  useImperativeHandle(\n    ref,\n    () => ({\n      editor: codeMirror,\n      preview: preview,\n    }),\n    [codeMirror],\n  );\n\n  const toolBarProps: ToolBarProps = {\n    preview: preview,\n    editor: codeMirror,\n    container: container,\n    containerEditor: containerEditor,\n    editorProps: { ...props, previewWidth },\n  };\n  const height = typeof codemirrorProps.height === 'number' ? `${codemirrorProps.height}px` : codemirrorProps.height;\n\n  const previewScrollHandle = useCallback(\n    (event: Event) => {\n      if (!enableScroll) return;\n      const target = event.target as HTMLDivElement;\n      const percent = target.scrollTop / target.scrollHeight;\n      if (active.current === 'editor' && preview.current) {\n        const previewHeihgt = preview.current?.scrollHeight || 0;\n        preview.current!.scrollTop = previewHeihgt * percent;\n      } else if (codeMirror.current && codeMirror.current.view) {\n        const editorScrollDom = codeMirror.current.view.scrollDOM;\n        const editorScrollHeihgt = codeMirror.current.view.scrollDOM.scrollHeight || 0;\n        editorScrollDom.scrollTop = editorScrollHeihgt * percent;\n      }\n    },\n    [enableScroll],\n  );\n  const mouseoverHandle = () => (active.current = 'preview');\n  const mouseleaveHandle = () => (active.current = 'editor');\n  useEffect(() => {\n    const $preview = preview.current;\n    if ($preview && enableScroll) {\n      $preview.addEventListener('mouseover', mouseoverHandle, false);\n      $preview.addEventListener('mouseleave', mouseleaveHandle, false);\n      $preview.addEventListener('scroll', previewScrollHandle, false);\n    }\n    return () => {\n      if ($preview && enableScroll) {\n        $preview.removeEventListener('mouseover', mouseoverHandle);\n        $preview.removeEventListener('mouseleave', mouseoverHandle);\n        $preview.addEventListener('mouseleave', previewScrollHandle, false);\n      }\n    };\n  }, [preview, enableScroll, previewScrollHandle]);\n\n  const scrollExtensions = events.scroll({\n    scroll: previewScrollHandle,\n  });\n\n  let extensionsData: IMarkdownEditor['extensions'] = reExtensions\n    ? reExtensions\n    : [markdown({ base: markdownLanguage, codeLanguages: languages }), scrollerStyle, ...extensions];\n  if (enableScroll) {\n    extensionsData.push(scrollExtensions);\n  }\n  const clsPreview = `${prefixCls}-preview`;\n  const cls = [prefixCls, 'wmde-markdown-var', className].filter(Boolean).join(' ');\n  previewProps['source'] = value;\n  const handleChange = (value: string, viewUpdate: ViewUpdate) => {\n    setValue(value);\n    onChange && onChange(value, viewUpdate);\n  };\n  const conentView = (\n    <div className={`${prefixCls}-content`} style={{ height: codemirrorProps.height }}>\n      <div className={`${prefixCls}-content-editor`} ref={containerEditor}>\n        {visibleEditor && (\n          <CodeMirror\n            theme={defaultTheme}\n            {...codemirrorProps}\n            extensions={extensionsData}\n            height={height}\n            ref={codeMirror}\n            onChange={handleChange}\n          />\n        )}\n      </div>\n      <div className={clsPreview} ref={preview}>\n        {renderPreview ? (\n          renderPreview(previewProps, !!visible)\n        ) : (\n          <MarkdownPreview {...previewProps} data-visible={!!visible} />\n        )}\n      </div>\n    </div>\n  );\n\n  const clsToolbar = [\n    prefixCls && `${prefixCls}-toolbar-warp`,\n    prefixCls && toolbarBottom && `${prefixCls}-toolbar-bottom`,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  const tools = toolbarsFilter ? toolbars.filter(toolbarsFilter) : toolbars;\n  const toolsMode = toolbarsFilter ? toolbarsMode.filter(toolbarsFilter) : toolbarsMode;\n  const toolbarView = hideToolbar && (\n    <div className={clsToolbar}>\n      <ToolBar {...toolBarProps} toolbars={tools} />\n      <ToolBar {...toolBarProps} toolbars={toolsMode} mode />\n    </div>\n  );\n  const child = toolbarBottom ? (\n    <Fragment>\n      {conentView}\n      {toolbarView}\n    </Fragment>\n  ) : (\n    <Fragment>\n      {toolbarView}\n      {conentView}\n    </Fragment>\n  );\n  return (\n    <div className={cls} ref={container}>\n      {child}\n    </div>\n  );\n}\n"
  ],
  "mappings": "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"
}