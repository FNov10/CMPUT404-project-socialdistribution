{
  "version": 3,
  "names": [
    "scrollerStyle",
    "EditorView",
    "theme",
    "borderBottomRightRadius",
    "borderBottomLeftRadius",
    "MarkdownEditor",
    "React",
    "forwardRef",
    "MarkdownEditorInternal",
    "Markdown",
    "MarkdownPreview",
    "props",
    "ref",
    "prefixCls",
    "className",
    "onChange",
    "toolbars",
    "getCommands",
    "toolbarsMode",
    "getModeCommands",
    "toolbarsFilter",
    "visible",
    "renderPreview",
    "visibleEditor",
    "hideToolbar",
    "toolbarBottom",
    "enableScroll",
    "previewProps",
    "extensions",
    "previewWidth",
    "reExtensions",
    "codemirrorProps",
    "useState",
    "value",
    "setValue",
    "codeMirror",
    "useRef",
    "container",
    "containerEditor",
    "preview",
    "active",
    "useImperativeHandle",
    "editor",
    "toolBarProps",
    "editorProps",
    "height",
    "previewScrollHandle",
    "useCallback",
    "event",
    "target",
    "percent",
    "scrollTop",
    "scrollHeight",
    "current",
    "previewHeihgt",
    "view",
    "editorScrollDom",
    "scrollDOM",
    "editorScrollHeihgt",
    "mouseoverHandle",
    "mouseleaveHandle",
    "useEffect",
    "$preview",
    "addEventListener",
    "removeEventListener",
    "scrollExtensions",
    "events",
    "scroll",
    "extensionsData",
    "markdown",
    "base",
    "markdownLanguage",
    "codeLanguages",
    "languages",
    "push",
    "clsPreview",
    "cls",
    "filter",
    "Boolean",
    "join",
    "handleChange",
    "viewUpdate",
    "conentView",
    "defaultTheme",
    "clsToolbar",
    "tools",
    "toolsMode",
    "toolbarView",
    "child"
  ],
  "sources": [
    "../src/index.tsx"
  ],
  "sourcesContent": [
    "import React, { useState, useRef, useImperativeHandle, Fragment, useEffect, useCallback } from 'react';\nimport { markdown, markdownLanguage } from '@codemirror/lang-markdown';\nimport { languages } from '@codemirror/language-data';\nimport { EditorView, ViewUpdate } from '@codemirror/view';\nimport * as events from '@uiw/codemirror-extensions-events';\nimport CodeMirror, { ReactCodeMirrorProps, ReactCodeMirrorRef } from '@uiw/react-codemirror';\nimport MarkdownPreview, { MarkdownPreviewProps } from '@uiw/react-markdown-preview';\nimport ToolBar, { Commands } from './components/ToolBar';\nimport { getCommands, getModeCommands } from './commands';\nimport { defaultTheme } from './theme';\nimport './index.less';\n\nexport * from './theme';\nexport * from './commands';\nexport * from '@uiw/react-markdown-preview';\n\nexport const scrollerStyle = EditorView.theme({\n  '&.cm-editor, & .cm-scroller': {\n    borderBottomRightRadius: '3px',\n    borderBottomLeftRadius: '3px',\n  },\n});\n\nexport interface IMarkdownEditor extends ReactCodeMirrorProps {\n  className?: string;\n  prefixCls?: string;\n  /** The raw markdown that will be converted to html (**required**) */\n  value?: string;\n  /** Shows a preview that will be converted to html. */\n  visible?: boolean;\n  visibleEditor?: boolean;\n  /** Override the default preview component */\n  renderPreview?: (props: MarkdownPreviewProps, initVisible: boolean) => React.ReactNode;\n  /** Preview expanded width @default `50%` */\n  previewWidth?: string;\n  /** Whether to enable scrolling */\n  enableScroll?: boolean;\n  /** Tool display settings. */\n  toolbars?: Commands[];\n  /** The tool on the right shows the settings. */\n  toolbarsMode?: Commands[];\n  /** Tool display filter settings. */\n  toolbarsFilter?: (tool: Commands, idx: number) => boolean;\n  /** Toolbar on bottom */\n  toolbarBottom?: boolean;\n  /** Option to hide the tool bar. */\n  hideToolbar?: boolean;\n  /** [@uiw/react-markdown-preview](https://github.com/uiwjs/react-markdown-preview#options-props) options */\n  previewProps?: MarkdownPreviewProps;\n  /** replace the default `extensions` */\n  reExtensions?: ReactCodeMirrorProps['extensions'];\n}\n\nexport interface ToolBarProps {\n  editor: React.RefObject<ReactCodeMirrorRef>;\n  preview: React.RefObject<HTMLDivElement>;\n  container: React.RefObject<HTMLDivElement>;\n  containerEditor: React.RefObject<HTMLDivElement>;\n  editorProps: IMarkdownEditor;\n}\n\nexport interface MarkdownEditorRef {\n  editor: React.RefObject<ReactCodeMirrorRef>;\n  preview: React.RefObject<HTMLDivElement> | null;\n}\n\nconst MarkdownEditor: MarkdownEditorComponent = React.forwardRef<MarkdownEditorRef, IMarkdownEditor>(\n  MarkdownEditorInternal,\n) as unknown as MarkdownEditorComponent;\n\ntype MarkdownEditorComponent = React.FC<React.PropsWithRef<IMarkdownEditor>> & {\n  Markdown: typeof MarkdownPreview;\n};\n\nMarkdownEditor.Markdown = MarkdownPreview;\n\nexport default MarkdownEditor;\n\nfunction MarkdownEditorInternal(\n  props: IMarkdownEditor,\n  ref?: ((instance: MarkdownEditorRef) => void) | React.RefObject<MarkdownEditorRef> | null,\n) {\n  const {\n    prefixCls = 'md-editor',\n    className,\n    onChange,\n    toolbars = getCommands(),\n    toolbarsMode = getModeCommands(),\n    toolbarsFilter,\n    visible = true,\n    renderPreview,\n    visibleEditor = true,\n    hideToolbar = true,\n    toolbarBottom = false,\n    enableScroll = true,\n    previewProps = {},\n    extensions = [],\n    previewWidth = '50%',\n    reExtensions,\n    ...codemirrorProps\n  } = props;\n  const [value, setValue] = useState(props.value || '');\n  const codeMirror = useRef<ReactCodeMirrorRef>(null);\n  const container = useRef<HTMLDivElement>(null);\n  const containerEditor = useRef<HTMLDivElement>(null);\n  const preview = useRef<HTMLDivElement>(null);\n  const active = useRef<'editor' | 'preview'>('editor');\n\n  useImperativeHandle(\n    ref,\n    () => ({\n      editor: codeMirror,\n      preview: preview,\n    }),\n    [codeMirror],\n  );\n\n  const toolBarProps: ToolBarProps = {\n    preview: preview,\n    editor: codeMirror,\n    container: container,\n    containerEditor: containerEditor,\n    editorProps: { ...props, previewWidth },\n  };\n  const height = typeof codemirrorProps.height === 'number' ? `${codemirrorProps.height}px` : codemirrorProps.height;\n\n  const previewScrollHandle = useCallback(\n    (event: Event) => {\n      if (!enableScroll) return;\n      const target = event.target as HTMLDivElement;\n      const percent = target.scrollTop / target.scrollHeight;\n      if (active.current === 'editor' && preview.current) {\n        const previewHeihgt = preview.current?.scrollHeight || 0;\n        preview.current!.scrollTop = previewHeihgt * percent;\n      } else if (codeMirror.current && codeMirror.current.view) {\n        const editorScrollDom = codeMirror.current.view.scrollDOM;\n        const editorScrollHeihgt = codeMirror.current.view.scrollDOM.scrollHeight || 0;\n        editorScrollDom.scrollTop = editorScrollHeihgt * percent;\n      }\n    },\n    [enableScroll],\n  );\n  const mouseoverHandle = () => (active.current = 'preview');\n  const mouseleaveHandle = () => (active.current = 'editor');\n  useEffect(() => {\n    const $preview = preview.current;\n    if ($preview && enableScroll) {\n      $preview.addEventListener('mouseover', mouseoverHandle, false);\n      $preview.addEventListener('mouseleave', mouseleaveHandle, false);\n      $preview.addEventListener('scroll', previewScrollHandle, false);\n    }\n    return () => {\n      if ($preview && enableScroll) {\n        $preview.removeEventListener('mouseover', mouseoverHandle);\n        $preview.removeEventListener('mouseleave', mouseoverHandle);\n        $preview.addEventListener('mouseleave', previewScrollHandle, false);\n      }\n    };\n  }, [preview, enableScroll, previewScrollHandle]);\n\n  const scrollExtensions = events.scroll({\n    scroll: previewScrollHandle,\n  });\n\n  let extensionsData: IMarkdownEditor['extensions'] = reExtensions\n    ? reExtensions\n    : [markdown({ base: markdownLanguage, codeLanguages: languages }), scrollerStyle, ...extensions];\n  if (enableScroll) {\n    extensionsData.push(scrollExtensions);\n  }\n  const clsPreview = `${prefixCls}-preview`;\n  const cls = [prefixCls, 'wmde-markdown-var', className].filter(Boolean).join(' ');\n  previewProps['source'] = value;\n  const handleChange = (value: string, viewUpdate: ViewUpdate) => {\n    setValue(value);\n    onChange && onChange(value, viewUpdate);\n  };\n  const conentView = (\n    <div className={`${prefixCls}-content`} style={{ height: codemirrorProps.height }}>\n      <div className={`${prefixCls}-content-editor`} ref={containerEditor}>\n        {visibleEditor && (\n          <CodeMirror\n            theme={defaultTheme}\n            {...codemirrorProps}\n            extensions={extensionsData}\n            height={height}\n            ref={codeMirror}\n            onChange={handleChange}\n          />\n        )}\n      </div>\n      <div className={clsPreview} ref={preview}>\n        {renderPreview ? (\n          renderPreview(previewProps, !!visible)\n        ) : (\n          <MarkdownPreview {...previewProps} data-visible={!!visible} />\n        )}\n      </div>\n    </div>\n  );\n\n  const clsToolbar = [\n    prefixCls && `${prefixCls}-toolbar-warp`,\n    prefixCls && toolbarBottom && `${prefixCls}-toolbar-bottom`,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  const tools = toolbarsFilter ? toolbars.filter(toolbarsFilter) : toolbars;\n  const toolsMode = toolbarsFilter ? toolbarsMode.filter(toolbarsFilter) : toolbarsMode;\n  const toolbarView = hideToolbar && (\n    <div className={clsToolbar}>\n      <ToolBar {...toolBarProps} toolbars={tools} />\n      <ToolBar {...toolBarProps} toolbars={toolsMode} mode />\n    </div>\n  );\n  const child = toolbarBottom ? (\n    <Fragment>\n      {conentView}\n      {toolbarView}\n    </Fragment>\n  ) : (\n    <Fragment>\n      {toolbarView}\n      {conentView}\n    </Fragment>\n  );\n  return (\n    <div className={cls} ref={container}>\n      {child}\n    </div>\n  );\n}\n"
  ],
  "mappings": "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"
}